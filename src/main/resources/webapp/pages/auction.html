<html>
<head>
    <link rel="import" href="/webapp/include/frameworks.html">
    <link rel="stylesheet" href="/webapp/css/main.css">

    <script type="text/javascript">
            $.urlParam = function(name){
                var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
                if(results == null) {
                    return null;
                } else {
                    return 0 || results[1];
                }
            }

            function loadComponents() {
                $.ajax({
                  type: "POST",
                  url: "/authenticateUser",
                  success: function (data) {
                    if(data.userAuthenticated != "Y" || data.type == 1) {
                        window.location.replace("/");
                    }
                  }
                });
                $("#header").load("../include/header.html");

                var productId = $.urlParam('productId');
                var requestData = {};

                if(productId != null) {
                    requestData.id = parseInt(productId);

                    $.ajax({
                      type: "GET",
                      url: "/getAuction",
                      data: requestData,
                      success: function (data) {
                        debugger;
                        $(".product-title").text(data.name);
                        $(".product-desc").text(data.description);
                        $(".product-price").text("R$" + data.price);
                        $("#defectDescription").text(data.defectDescription);
                        $("#item-display").attr("src", data.photosArray[0]);
                        for(var i = 1; i < data.photosArray.length; i++) {
                            $("#alternative-items").append("<a class='service1-item'><img src='" + data.photosArray[i] + "' /></a>");
                        }
                      }
                    });
                }
            }
            window.onload = loadComponents;
        </script>
</head>
    <body>
        <div class="container">
            <div id="header">
            </div>
            <div class="content-wrapper">
                <div class="item-container">
                    <div class="container">
                        <div class="col-md-5">
                            <div class="product col-md-8 service-image-left">
                                <center>
                                    <img id="item-display" src="" alt="" />
                                </center>
                            </div>
                            <div class="container service1-items col-md-4 pull-left">
                                <center id="alternative-items">
                                </center>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-12" >
                            <div class="product-title"></div>
                            <div class="product-desc"></div>
                            <hr>
                                <div class="product-price"></div>
                            <hr>
                            <button type="button" class="btn btn-success">
                                Efetuar Lance
                            </button>
                        </div>
                    </div>
                </div>
                <div class="col-md-12">
                    <ul id="myTab" class="nav nav-tabs nav_tabs">
                        <li><h1>Descri&ccedil;&atilde;o do defeito</h1></li>
                    </ul>
                    <div class="tab-pane fade in active" id="defectDescription">
                    </div>
                    <hr>
                </div>
            </div>
        </div>
    </body>
</html>
